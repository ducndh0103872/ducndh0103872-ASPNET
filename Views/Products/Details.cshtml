@model ShoeShopAnNhien.Models.Product
@{
    ViewData["Title"] = Model.Name;
}

<div class="container py-4">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Home")">Trang chủ</a></li>
            <li class="breadcrumb-item"><a href="@Url.Action("Index", "Products")">Sản phẩm</a></li>
            <li class="breadcrumb-item active">@Model.Name</li>
        </ol>
    </nav>

    <div class="row">
        <div class="col-md-6">
            <div class="product-images">
                <div class="main-image mb-3">
                    <img src="@(Model.MainImageUrl ?? "/images/products/default.jpg")" alt="@Model.Name" class="img-fluid rounded" style="width: 100%; height: 400px; object-fit: cover;">
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="product-info">
                <h1 class="h3 mb-3">@Model.Name</h1>
                <p class="text-muted mb-3">Thương hiệu: <strong>@Model.Brand.Name</strong></p>
                <p class="text-muted mb-3">Danh mục: <strong>@Model.Category.Name</strong></p>
                
                <div class="price-section mb-4">
                    @if (Model.IsOnSale)
                    {
                        <h3 class="text-danger mb-0">@Model.SalePrice?.ToString("N0") VNĐ</h3>
                        <p class="text-muted text-decoration-line-through">@Model.Price.ToString("N0") VNĐ</p>
                        <span class="badge bg-danger">Giảm @Model.DiscountPercentage%</span>
                    }
                    else
                    {
                        <h3 class="text-primary mb-0">@Model.Price.ToString("N0") VNĐ</h3>
                    }
                </div>
                
                <div class="product-description mb-4">
                    <h5>Mô tả sản phẩm</h5>
                    <p>@Model.Description</p>
                </div>
                
                @if (!string.IsNullOrEmpty(Model.AvailableSizes))
                {
                    <div class="sizes mb-3">
                        <h6>Kích thước có sẵn:</h6>
                        <div class="size-options">
                            @{
                                var sizes = Model.AvailableSizes.Trim('[', ']').Split(',').Select(s => s.Trim('\'', '"')).ToArray();
                            }
                            @foreach (var size in sizes)
                            {
                                <button class="btn btn-outline-secondary btn-sm me-2 mb-2" onclick="selectSize(this)">@size</button>
                            }
                        </div>
                    </div>
                }
                
                @if (!string.IsNullOrEmpty(Model.AvailableColors))
                {
                    <div class="colors mb-3">
                        <h6>Màu sắc có sẵn:</h6>
                        <div class="color-options">
                            @{
                                var colors = Model.AvailableColors.Trim('[', ']').Split(',').Select(c => c.Trim('\'', '"')).ToArray();
                            }
                            @foreach (var color in colors)
                            {
                                <button class="btn btn-outline-secondary btn-sm me-2 mb-2" onclick="selectColor(this)">@color</button>
                            }
                        </div>
                    </div>
                }
                
                <div class="quantity mb-4">
                    <h6>Số lượng:</h6>
                    <div class="input-group" style="width: 150px;">
                        <button class="btn btn-outline-secondary" type="button" onclick="decreaseQuantity()">-</button>
                        <input type="number" class="form-control text-center" id="quantity" value="1" min="1" max="@Model.StockQuantity">
                        <button class="btn btn-outline-secondary" type="button" onclick="increaseQuantity()">+</button>
                    </div>
                    <small class="text-muted">Còn lại: @Model.StockQuantity sản phẩm</small>
                </div>
                
                <div class="actions">
                    <button class="btn btn-primary btn-lg me-3" onclick="addToCart(@Model.Id)">
                        <i class="fas fa-cart-plus me-2"></i>Thêm vào giỏ hàng
                    </button>
                    <button class="btn btn-outline-danger" onclick="addToWishlist(@Model.Id)">
                        <i class="fas fa-heart"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function selectSize(btn) {
    document.querySelectorAll('.size-options .btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

function selectColor(btn) {
    document.querySelectorAll('.color-options .btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

function increaseQuantity() {
    const input = document.getElementById('quantity');
    const max = parseInt(input.getAttribute('max'));
    if (parseInt(input.value) < max) {
        input.value = parseInt(input.value) + 1;
    }
}

function decreaseQuantity() {
    const input = document.getElementById('quantity');
    if (parseInt(input.value) > 1) {
        input.value = parseInt(input.value) - 1;
    }
}
</script>